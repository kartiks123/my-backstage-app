{"version":3,"file":"index-5bcdfb7d.esm.js","sources":["../../src/api/types.ts","../../src/hooks/useCalendarsQuery.ts","../../src/hooks/useEventsQuery.ts","../../src/hooks/useSignIn.ts","../../src/components/AttendeeChip.tsx","../../src/components/util.ts","../../src/components/CalendarEventPopoverContent.tsx","../../src/components/CalendarEvent.tsx","../../src/components/CalendarSelect.tsx","../../src/components/SignInContent.tsx","../../src/components/CalendarCard.tsx","../../src/components/MicrosoftCalendar.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Calendar as MicrosoftCalendar,\n  Event as MicrosoftCalendarEvent,\n  Attendee,\n  ResponseStatus,\n  DateTimeTimeZone,\n  EmailAddress,\n} from '@microsoft/microsoft-graph-types';\n\nexport type {\n  MicrosoftCalendar,\n  MicrosoftCalendarEvent,\n  Attendee,\n  ResponseStatus,\n  DateTimeTimeZone,\n  EmailAddress,\n};\n\nexport const ResponseStatusMap = {\n  needsAction: 'none',\n  accepted: 'accepted',\n  declined: 'declined',\n  maybe: 'tentativelyAccepted',\n  notResponded: 'notResponded',\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useQuery } from '@tanstack/react-query';\n\nimport { errorApiRef, useApi } from '@backstage/core-plugin-api';\n\nimport { microsoftCalendarApiRef } from '../api';\n\ntype Options = {\n  enabled: boolean;\n  refreshTime?: number;\n};\n\nexport const useCalendarsQuery = ({ enabled }: Options) => {\n  const calendarApi = useApi(microsoftCalendarApiRef);\n  const errorApi = useApi(errorApiRef);\n\n  return useQuery(\n    ['calendars-list'],\n    async () => {\n      const calendars = [];\n      const value = await calendarApi.getCalendars();\n      calendars.push(...value);\n      return calendars;\n    },\n    {\n      enabled,\n      // old data will be returned if last request was made within 3 mins.\n      staleTime: 180000,\n      refetchInterval: 3600000,\n      onError: () => {\n        errorApi.post({\n          name: 'API error',\n          message: 'Failed to fetch calendars.',\n        });\n      },\n    },\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useQuery } from '@tanstack/react-query';\n\nimport { useApi } from '@backstage/core-plugin-api';\n\nimport { microsoftCalendarApiRef } from '../api';\n\ntype Options = {\n  calendarId: string;\n  timeMin: string;\n  timeMax: string;\n  enabled?: boolean;\n  timeZone?: string;\n  refreshTime?: number;\n};\n\nexport const useEventsQuery = ({\n  calendarId,\n  enabled,\n  timeMin,\n  timeMax,\n  timeZone,\n}: Options) => {\n  const calendarApi = useApi(microsoftCalendarApiRef);\n  return useQuery(\n    ['calendarEvents', calendarId, timeMin, timeMax, timeZone],\n    async () => {\n      const data = await calendarApi.getEvents(\n        calendarId,\n        {\n          startDateTime: timeMin,\n          endDateTime: timeMax,\n        },\n        {\n          Prefer: `outlook.timezone=\"${timeZone}\"`,\n        },\n      );\n      return data;\n    },\n    {\n      cacheTime: 300000,\n      enabled,\n      refetchInterval: 60000,\n      refetchIntervalInBackground: true,\n    },\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useCallback, useState } from 'react';\n\nimport { microsoftAuthApiRef, useApi } from '@backstage/core-plugin-api';\n\nexport const useSignIn = () => {\n  const [isSignedIn, setSignedIn] = useState(false);\n  const [isInitialized, setInitialized] = useState(false);\n  const authApi = useApi(microsoftAuthApiRef);\n\n  const signIn = useCallback(\n    async (optional = false) => {\n      const token = await authApi.getAccessToken('Calendars.Read', {\n        optional,\n        instantPopup: !optional,\n      });\n\n      setSignedIn(!!token);\n      setInitialized(true);\n    },\n    [authApi, setSignedIn],\n  );\n\n  return { isSignedIn, isInitialized, signIn };\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Badge, Chip, makeStyles } from '@material-ui/core';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport CheckIcon from '@material-ui/icons/CheckCircle';\nimport { Attendee, ResponseStatusMap } from '../api';\n\nconst useStyles = makeStyles(theme => {\n  const getIconColor = (responseStatus?: string) => {\n    if (!responseStatus) return theme.palette.primary.light;\n\n    return {\n      [ResponseStatusMap.accepted]: theme.palette.status.ok,\n      [ResponseStatusMap.declined]: theme.palette.status.error,\n    }[responseStatus];\n  };\n\n  return {\n    responseStatus: {\n      color: ({ responseStatus }: { responseStatus?: string }) =>\n        getIconColor(responseStatus),\n    },\n    badge: {\n      right: 10,\n      top: 5,\n      '& svg': {\n        height: 16,\n        width: 16,\n        background: theme.palette.common.white,\n      },\n    },\n  };\n});\n\nconst ResponseIcon = ({ responseStatus }: { responseStatus: string }) => {\n  if (responseStatus === ResponseStatusMap.accepted) {\n    return <CheckIcon data-testid=\"accepted-icon\" />;\n  }\n  if (responseStatus === ResponseStatusMap.declined) {\n    return <CancelIcon data-testid=\"declined-icon\" />;\n  }\n\n  return null;\n};\n\ntype AttendeeChipProps = {\n  user: Attendee;\n};\n\nexport const AttendeeChip = ({ user }: AttendeeChipProps) => {\n  const classes = useStyles({ responseStatus: user.status?.response || '' });\n\n  return (\n    <Badge\n      classes={{\n        root: classes.responseStatus,\n        badge: classes.badge,\n      }}\n      badgeContent={\n        <ResponseIcon responseStatus={user.status?.response || ''} />\n      }\n    >\n      <Chip\n        size=\"small\"\n        variant=\"outlined\"\n        label={user.emailAddress?.address}\n        color=\"primary\"\n      />\n    </Badge>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DateTime } from 'luxon';\n\nimport { MicrosoftCalendarEvent } from '../api';\n\nexport function getOnlineMeetingLink(event: MicrosoftCalendarEvent) {\n  const onlineEntrypoint =\n    event.onlineMeeting?.joinUrl || event.onlineMeetingUrl;\n  if (onlineEntrypoint) {\n    return onlineEntrypoint;\n  }\n  return '';\n}\n\nexport function getTimePeriod(event: MicrosoftCalendarEvent) {\n  if (isAllDay(event)) {\n    return getAllDayTimePeriod(event);\n  }\n\n  const format: Intl.DateTimeFormatOptions = {\n    hour: '2-digit',\n    minute: '2-digit',\n  };\n\n  const startTime = DateTime.fromISO(event.start?.dateTime || '');\n  const endTime = DateTime.fromISO(event.end?.dateTime || '');\n\n  return `${startTime.toLocaleString(format)} - ${endTime.toLocaleString(\n    format,\n  )}`;\n}\n\nfunction getAllDayTimePeriod(event: MicrosoftCalendarEvent) {\n  const format: Intl.DateTimeFormatOptions = { month: 'long', day: 'numeric' };\n  const startTime = DateTime.fromISO(event.start?.dateTime || '');\n  const endTime = DateTime.fromISO(event.end?.dateTime || '').minus({ day: 1 });\n\n  if (startTime.toISO() === endTime.toISO()) {\n    return startTime.toLocaleString(format);\n  }\n\n  return `${startTime.toLocaleString(format)} - ${endTime.toLocaleString(\n    format,\n  )}`;\n}\n\nexport function isPassed(event: MicrosoftCalendarEvent) {\n  if (!event.end?.dateTime) return false;\n  const eventDate = DateTime.fromISO(event.end?.dateTime!);\n  return DateTime.now() >= eventDate;\n}\n\nexport function isAllDay(event: MicrosoftCalendarEvent) {\n  const startTime = DateTime.fromISO(event.start?.dateTime || '');\n  const endTime = DateTime.fromISO(event.end?.dateTime || '');\n\n  return endTime.diff(startTime, 'day').days >= 1;\n}\n\nexport function getStartDate(event: MicrosoftCalendarEvent) {\n  return DateTime.fromISO(event.start?.dateTime || '');\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { sortBy } from 'lodash';\nimport React from 'react';\nimport DOMPurify from 'dompurify';\n\nimport { Link } from '@backstage/core-components';\nimport {\n  Box,\n  Divider,\n  IconButton,\n  Tooltip,\n  Typography,\n  makeStyles,\n} from '@material-ui/core';\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\n\nimport { AttendeeChip } from './AttendeeChip';\nimport { MicrosoftCalendarEvent } from '../api';\nimport { getTimePeriod, getOnlineMeetingLink } from './util';\n\nconst useStyles = makeStyles(\n  theme => ({\n    description: {\n      wordBreak: 'break-word',\n      '& a': {\n        color: theme.palette.primary.main,\n        fontWeight: 500,\n      },\n    },\n    divider: {\n      marginTop: theme.spacing(2),\n      marginBottom: theme.spacing(2),\n    },\n  }),\n  {\n    name: 'MicrosoftCalendarEventPopoverContent',\n  },\n);\n\ntype CalendarEventPopoverProps = {\n  event: MicrosoftCalendarEvent;\n};\n\nexport const CalendarEventPopoverContent = ({\n  event,\n}: CalendarEventPopoverProps) => {\n  const classes = useStyles();\n  const onlineMeetingLink = getOnlineMeetingLink(event);\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" width={400} p={2}>\n      <Box display=\"flex\" alignItems=\"center\">\n        <Box flex={1}>\n          <Typography variant=\"h6\">{event.subject}</Typography>\n          <Typography variant=\"subtitle2\">{getTimePeriod(event)}</Typography>\n        </Box>\n        {event.webLink && (\n          <Tooltip title=\"Open in Calendar\">\n            <Link\n              data-testid=\"open-calendar-link\"\n              to={event.webLink}\n              onClick={_e => {}}\n              noTrack\n            >\n              <IconButton>\n                <ArrowForwardIcon />\n              </IconButton>\n            </Link>\n          </Tooltip>\n        )}\n      </Box>\n      {onlineMeetingLink && (\n        <Link to={onlineMeetingLink} onClick={_e => {}} noTrack>\n          Join Online Meeting\n        </Link>\n      )}\n\n      {event.bodyPreview && (\n        <>\n          <Divider className={classes.divider} variant=\"fullWidth\" />\n          <Box\n            className={classes.description}\n            dangerouslySetInnerHTML={{\n              __html: DOMPurify.sanitize(\n                (event.body && event.body.content) || '',\n                {\n                  USE_PROFILES: { html: true },\n                },\n              ),\n            }}\n          />\n        </>\n      )}\n\n      {event.attendees && (\n        <>\n          <Divider className={classes.divider} variant=\"fullWidth\" />\n          <Box>\n            <Typography variant=\"subtitle2\">Attendees</Typography>\n            <Box mb={1} />\n            {sortBy(event.attendees || [], 'emailAddress').map(user => (\n              <AttendeeChip\n                key={user.emailAddress?.address || ''}\n                user={user}\n              />\n            ))}\n          </Box>\n        </>\n      )}\n    </Box>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport classnames from 'classnames';\nimport {\n  bindPopover,\n  bindTrigger,\n  usePopupState,\n} from 'material-ui-popup-state/hooks';\nimport React, { useState } from 'react';\n\nimport { Link } from '@backstage/core-components';\n\nimport {\n  Box,\n  Paper,\n  Popover,\n  Tooltip,\n  Typography,\n  makeStyles,\n} from '@material-ui/core';\n\nimport webcamIcon from '../icons/webcam.svg';\nimport { CalendarEventPopoverContent } from './CalendarEventPopoverContent';\nimport { MicrosoftCalendarEvent } from '../api';\nimport {\n  getOnlineMeetingLink,\n  getTimePeriod,\n  isAllDay,\n  isPassed,\n} from './util';\n\nconst useStyles = makeStyles(\n  theme => ({\n    event: {\n      display: 'flex',\n      alignItems: 'center',\n      marginBottom: theme.spacing(1),\n      cursor: 'pointer',\n      paddingRight: 12,\n    },\n    declined: {\n      textDecoration: 'line-through',\n    },\n    passed: {\n      opacity: 0.6,\n      transition: 'opacity 0.15s ease-in-out',\n      '&:hover': {\n        opacity: 1,\n      },\n    },\n    link: {\n      width: 48,\n      height: 48,\n      display: 'inline-block',\n      padding: 8,\n      borderRadius: '50%',\n      '&:hover': {\n        backgroundColor: theme.palette.grey[100],\n      },\n    },\n    calendarColor: {\n      width: 8,\n      borderTopLeftRadius: 4,\n      borderBottomLeftRadius: 4,\n    },\n  }),\n  {\n    name: 'MicrosoftCalendarEvent',\n  },\n);\n\nexport const CalendarEvent = ({ event }: { event: MicrosoftCalendarEvent }) => {\n  const classes = useStyles();\n  const popoverState = usePopupState({\n    variant: 'popover',\n    popupId: event.id,\n    disableAutoFocus: true,\n  });\n  const [hovered, setHovered] = useState(false);\n  const onlineMeetingLink = getOnlineMeetingLink(event);\n\n  const { onClick, ...restBindProps } = bindTrigger(popoverState);\n\n  return (\n    <>\n      <Paper\n        onClick={e => {\n          onClick(e);\n        }}\n        {...restBindProps}\n        onMouseEnter={() => setHovered(true)}\n        onMouseLeave={() => setHovered(false)}\n        elevation={hovered ? 4 : 1}\n        className={classnames(classes.event, {\n          [classes.passed]: isPassed(event),\n        })}\n        data-testid=\"microsoft-calendar-event\"\n      >\n        <Box className={classes.calendarColor} mr={1} alignSelf=\"stretch\" />\n        <Box flex={1} pt={1} pb={1}>\n          <Typography\n            variant=\"subtitle2\"\n            className={classnames({ [classes.declined]: event.isCancelled })}\n          >\n            {event.subject}\n          </Typography>\n          {!isAllDay(event) && (\n            <Typography variant=\"body2\" data-testid=\"calendar-event-time\">\n              {getTimePeriod(event)}\n            </Typography>\n          )}\n        </Box>\n\n        {event.isOnlineMeeting && (\n          <Tooltip title=\"Join Online Meeting\">\n            <Link\n              data-testid=\"calendar-event-online-meeting-link\"\n              className={classes.link}\n              to={onlineMeetingLink}\n              onClick={e => {\n                e.stopPropagation();\n              }}\n              noTrack\n            >\n              {/* we can use onlineMeetingProvider to show icon accordingly */}\n              <img\n                height={32}\n                width={32}\n                src={webcamIcon}\n                alt=\"Online Meeting link\"\n              />\n            </Link>\n          </Tooltip>\n        )}\n      </Paper>\n\n      <Popover\n        {...bindPopover(popoverState)}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'center',\n        }}\n        data-testid=\"calendar-event-popover\"\n      >\n        <CalendarEventPopoverContent event={event} />\n      </Popover>\n    </>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { sortBy } from 'lodash';\nimport React from 'react';\n\nimport {\n  Checkbox,\n  FormControl,\n  Input,\n  ListItemText,\n  MenuItem,\n  Select,\n  Typography,\n  makeStyles,\n} from '@material-ui/core';\nimport { MicrosoftCalendar } from '../api';\n\nconst useStyles = makeStyles(\n  {\n    formControl: {\n      width: 120,\n    },\n    selectedCalendars: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n    },\n  },\n  {\n    name: 'MicrosoftCalendarSelect',\n  },\n);\n\ntype CalendarSelectProps = {\n  disabled: boolean;\n  selectedCalendarId?: string;\n  setSelectedCalendarId: (value: string) => void;\n  calendars: MicrosoftCalendar[];\n};\n\nexport const CalendarSelect = ({\n  disabled,\n  selectedCalendarId,\n  setSelectedCalendarId,\n  calendars,\n}: CalendarSelectProps) => {\n  const classes = useStyles();\n  return (\n    <FormControl className={classes.formControl}>\n      <Select\n        labelId=\"calendars-label\"\n        disabled={disabled || calendars.length === 0}\n        value={selectedCalendarId || ''}\n        onChange={async e => setSelectedCalendarId(e.target.value as string)}\n        input={<Input />}\n        renderValue={selected => {\n          return (\n            <Typography className={classes.selectedCalendars} variant=\"body2\">\n              {calendars.find(c => c.id === selected)?.name}\n            </Typography>\n          );\n        }}\n        MenuProps={{\n          PaperProps: {\n            style: {\n              width: 350,\n            },\n          },\n        }}\n      >\n        {sortBy(calendars, 'name').map(c => (\n          <MenuItem key={c.id} value={c.id}>\n            <Checkbox checked={c.id === selectedCalendarId} />\n            <ListItemText primary={c.name} />\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Box, Button, styled } from '@material-ui/core';\nimport { CalendarEvent } from './CalendarEvent';\nimport mockEvents from './eventMock.json';\nimport { MicrosoftCalendarEvent } from '../api';\n\ntype Props = {\n  handleAuthClick: React.MouseEventHandler<HTMLElement>;\n};\n\nconst TransparentBox = styled(Box)({\n  opacity: 0.3,\n  filter: 'blur(1.5px)',\n});\n\nexport const SignInContent = ({ handleAuthClick }: Props) => {\n  return (\n    <Box position=\"relative\" height=\"100%\" width=\"100%\">\n      <TransparentBox p={1}>\n        {(mockEvents as MicrosoftCalendarEvent[]).map(event => (\n          <CalendarEvent key={event.id} event={event} />\n        ))}\n      </TransparentBox>\n\n      <Box\n        height=\"100%\"\n        width=\"100%\"\n        display=\"flex\"\n        justifyContent=\"center\"\n        alignItems=\"center\"\n        position=\"absolute\"\n        left={0}\n        top={0}\n      >\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={handleAuthClick}\n          size=\"large\"\n        >\n          Sign in\n        </Button>\n      </Box>\n    </Box>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { sortBy } from 'lodash';\nimport { DateTime } from 'luxon';\nimport React, { useState } from 'react';\n\nimport { InfoCard, Progress } from '@backstage/core-components';\n\nimport { Box, IconButton, Typography } from '@material-ui/core';\nimport PrevIcon from '@material-ui/icons/NavigateBefore';\nimport NextIcon from '@material-ui/icons/NavigateNext';\n\nimport { useCalendarsQuery, useEventsQuery, useSignIn } from '../hooks';\nimport calendarIcon from '../icons/calendar.svg';\nimport { CalendarEvent } from './CalendarEvent';\nimport { CalendarSelect } from './CalendarSelect';\nimport { SignInContent } from './SignInContent';\nimport { getStartDate } from './util';\nimport useAsync from 'react-use/lib/useAsync';\n\nexport const CalendarCard = () => {\n  const [date, setDate] = useState(DateTime.now());\n  const [selectedCalendarId, setSelectedCalendarId] = useState('');\n\n  const changeDay = (offset = 1) => {\n    setDate(prev => prev.plus({ day: offset }));\n  };\n\n  const { isSignedIn, isInitialized, signIn } = useSignIn();\n\n  useAsync(async () => signIn(true), [signIn]);\n\n  const {\n    isLoading: isCalendarLoading,\n    isFetching: isCalendarFetching,\n    data: calendars = [],\n  } = useCalendarsQuery({\n    enabled: isSignedIn,\n  });\n\n  const defaultCalendarId = calendars.find(c => c.isDefaultCalendar)?.id;\n\n  const { data: events, isLoading: isEventLoading } = useEventsQuery({\n    calendarId: selectedCalendarId || defaultCalendarId || '',\n    enabled: isSignedIn && calendars.length > 0,\n    timeMin: date.startOf('day').toISO()!,\n    timeMax: date.endOf('day').toISO()!,\n    timeZone: date.zoneName ?? undefined,\n  });\n\n  const showLoader =\n    (isCalendarLoading && isCalendarFetching) ||\n    isEventLoading ||\n    !isInitialized;\n\n  return (\n    <InfoCard\n      noPadding\n      title={\n        <Box display=\"flex\" alignItems=\"center\">\n          <Box height={32} width={32} mr={1}>\n            <img src={calendarIcon} alt=\"Microsoft Calendar\" />\n          </Box>\n          {isSignedIn ? (\n            <>\n              <IconButton onClick={() => changeDay(-1)} size=\"small\">\n                <PrevIcon />\n              </IconButton>\n              <IconButton onClick={() => changeDay(1)} size=\"small\">\n                <NextIcon />\n              </IconButton>\n              <Box mr={0.5} />\n              <Typography variant=\"h6\">\n                {date.toLocaleString({\n                  weekday: 'short',\n                  month: 'short',\n                  day: 'numeric',\n                })}\n              </Typography>\n\n              <Box flex={1} />\n\n              <CalendarSelect\n                calendars={calendars}\n                selectedCalendarId={selectedCalendarId || defaultCalendarId}\n                setSelectedCalendarId={setSelectedCalendarId}\n                disabled={\n                  (isCalendarFetching && isCalendarLoading) || !isSignedIn\n                }\n              />\n            </>\n          ) : (\n            <Typography variant=\"h6\">Agenda</Typography>\n          )}\n        </Box>\n      }\n      deepLink={{\n        link: 'https://outlook.office.com/calendar/',\n        title: 'Go to Calendar',\n      }}\n    >\n      <Box>\n        {showLoader && (\n          <Box py={2}>\n            <Progress variant=\"query\" />\n          </Box>\n        )}\n        {!isSignedIn && isInitialized && (\n          <SignInContent handleAuthClick={() => signIn(false)} />\n        )}\n        {!isEventLoading && !isCalendarLoading && isSignedIn && (\n          <Box p={1} pb={0} maxHeight={602} overflow=\"auto\">\n            {events?.length === 0 && (\n              <Box pt={2} pb={2}>\n                <Typography align=\"center\" variant=\"h6\">\n                  No events\n                </Typography>\n              </Box>\n            )}\n            {sortBy(events, [getStartDate]).map(event => (\n              <CalendarEvent key={`${event.id}`} event={event} />\n            ))}\n          </Box>\n        )}\n      </Box>\n    </InfoCard>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\n\nimport { CalendarCard } from './CalendarCard';\n\nconst queryClient = new QueryClient();\n\nexport const MicrosoftCalendar = () => {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <CalendarCard />\n    </QueryClientProvider>\n  );\n};\n"],"names":["useStyles"],"mappings":"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"}